@page "/reporte-socios"
@inject SociosApp.Services.SupabaseService Supabase
@inject IJSRuntime JS

<h3 class="no-print">📋 Listado de Socios</h3>
<div class="encabezado-impresion">
    <h2>Listado de Socios</h2>
    <p>Fecha: @DateTime.Now.ToString("dd/MM/yyyy")</p>
</div>

<div class="no-print mb-3">
    <button class="btn btn-secondary" @onclick="Imprimir">🖨️ Imprimir</button>
</div>

@if (socios is null)
{
    <p>Cargando socios...</p>
}
else if (socios.Count == 0)
{
    <p>No hay socios registrados.</p>
}
else
{
    <div id="area-impresion">
        <table class="table table-striped table-bordered">
            <thead>
                <tr>
                    <th>Apellido</th>
                    <th>Nombre</th>
                    <th>Estado</th>
                    <th>Teléfono</th>
                    <th>Email</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var s in socios)
                {
                    <tr>
                        <td>@s.Apellido</td>
                        <td>@s.Nombre</td>
                        <td>@s.Estado</td>
                        <td>@s.Telefono</td>
                        <td>@s.Email</td>
                    </tr>
                }
            </tbody>
        </table>

        <p class="mt-3 fw-bold">Total de socios: @socios.Count</p>
    </div>
}

@code {
    private List<Socio>? socios;

    protected override async Task OnInitializedAsync()
    {
        socios = await Supabase.GetSociosAsync();
    }

    private async Task Imprimir()
    {
        await JS.InvokeVoidAsync("window.print");
    }
}

<style>
    @@media print {
        /* Ocultar elementos que no se deben imprimir */
        .no-print {
            display: none !important;
        }

        /* Repetir encabezado de tabla en cada página */
        table {
            border-collapse: collapse;
            width: 100%;
        }

        thead {
            display: table-header-group; /* 👈 Esto hace la magia */
        }

        tfoot {
            display: table-footer-group; /* 👈 Si querés también pies repetidos */
        }

        /* Opcional: márgenes de página */
        @@page {
            margin: 1.5cm;
        }

        /* Opcional: tamaño de fuente más compacto */
        body {
            font-size: 12px;
        }
    }
</style>
